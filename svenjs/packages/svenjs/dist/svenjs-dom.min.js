!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.InfernoDOM=t()}(this,function(){"use strict";function e(e,n){if(!o(e)){var r=t(e);(r&&e.length>0||!r)&&(n=n?Object.assign({},n,{children:e}):{children:e})}return n}function t(e){return e instanceof Array}function n(e){return e.prototype&&void 0!==e.prototype.render}function r(e){return s(e)||a(e)}function o(e){return d(e)||u(e)}function l(e){return u(e)||e===!1||e===!0||d(e)}function i(e){return"function"==typeof e}function s(e){return"string"==typeof e}function a(e){return"number"==typeof e}function u(e){return null===e}function c(e){return e===!0}function d(e){return void 0===e}function f(e,n){if(!l(e))if(t(e))for(var r=0;r<e.length;r++){var o=e[r];if(!l(o)){if(o===n)return!0;if(o.children)return f(o.children,n)}}else{if(e===n)return!0;if(e.children)return f(e.children,n)}return!1}function h(e,t){if(t){var n=t.props.children;if(f(n,e))return h(e,t._parentComponent)}return t}function m(e,t,n,r,l){if(void 0!==t){var i=t.pool,s=i.pop();if(!o(s))return he(s,e,null,n,r,l,t.isSVG),e.dom}return null}function v(e){var t=e.bp;return!o(t)&&(t.pool.push(e),!0)}function p(e,t){j(e)?g(e,t,!0):D(e)&&y(e,t,!1)}function g(e,t,n){var r=e.items,o=r.length,l=e.pointer;if(o>0)for(var i=0;i<o;i++){var s=r[i];j(s)?g(s,t,!0):(t&&L(t,s.dom),p(s,null))}t&&n&&L(t,l)}function y(e,n,r){var l=e.instance,i=null,s=null;o(l)||(i=l.hooks,s=l.children,void 0!==l.render&&(l.componentWillUnmount(),l._unmounted=!0,nt.delete(l),!r&&p(l._lastNode,null)));var a=e.hooks||i;o(a)||(o(a.willDetach)||a.willDetach(e.dom),o(a.componentWillUnmount)||a.componentWillUnmount(e.dom,a));var u=(o(l)?e.children:null)||s;if(!o(u))if(t(u))for(var c=0;c<u.length;c++)p(u[c],null);else p(u,null)}function w(e){this.bp=e,this.dom=null,this.instance=null,this.tag=null,this.children=null,this.style=null,this.className=null,this.attrs=null,this.events=null,this.hooks=null,this.key=null,this.clipData=null}function k(e){this.text=e,this.dom=null}function x(){this.placeholder=!0,this.dom=null}function b(e){this.dom=null,this.pointer=null,this.items=e}function C(e){return new k(e)}function N(){return new x}function S(e){return new b(e)}function _(e,t,n){e.split(",").forEach(function(e){return t[e]=n})}function O(e){return void 0!==e.text}function M(e){return e.placeholder===!0}function j(e){return void 0!==e.items}function D(e){return void 0!==e.tag||void 0!==e.bp}function T(e,t,n){o(n)?e.appendChild(t):e.insertBefore(t,n)}function E(e,t,n){var r=t.pointer;g(t,e,!1),W(e,n,r)}function U(e,t){var n;return n=t===!0?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e)}function V(e,t,n){if(null===t)return document.createTextNode(e);if(n){if(""!==e)return t.textContent=e,t.firstChild;var r=document.createTextNode("");return t.appendChild(r),r}var o=document.createTextNode(e);return t.appendChild(o),o}function G(e,t,n,r,l,i,s){var a=null,u=e._lastNode;o(u)||(a=e,e=u),p(e,!1);var c=Q(t,null,r,l,i,s);t.dom=c,W(n,c,e.dom),null!==a&&(a._lastNode=t)}function W(e,t,n){e.replaceChild(t,n)}function A(e){return r(e)?C(e):l(e)?N():t(e)?S(e):e}function H(e,t){var n=e[t];return e[t]=A(n)}function K(e,t){if(j(e))return p(e,t);var n=e.dom;n===t?n.innerHTML="":(L(t,n),Ie&&v(e)),p(e,!1)}function L(e,t){e.removeChild(t)}function Y(e,t,n){for(var r=t||Object.keys(e),o=0;o<r.length;o++){var l=r[o];n[l]=null}}function I(){return document.activeElement}function X(e,t){if(Ie){var n=t.length;if(n>5)for(var r=0;r<n;r++){var o=t[r];l(o)||v(o)}}e.textContent=""}function z(e){null!==e&&e!==document.body&&document.activeElement!==e&&e.focus()}function R(e,t){return!e.complex&&(t.length&&!o(t[0])&&!o(t[0].key)&&e.length&&!o(e[0])&&!o(e[0].key))}function F(e,t){if("option"===e.tag){var n=e.attrs&&e.attrs.value;t[n]?(e.attrs=e.attrs||{},e.attrs.selected="selected",e.dom.selected=!0):e.dom.selected=!1}else for(var r=0,o=e.children.length;r<o;r++)F(e.children[r],t)}function q(e){var n=e.attrs&&e.attrs.value,r={};if(t(n))for(var o=0,l=n.length;o<l;o++)r[n[o]]=n[o];else r[n]=n;for(var i=0,s=e.children.length;i<s;i++)F(e.children[i],r);e.attrs&&e.attrs[n]&&delete e.attrs.value}function B(e,t,n){o(e.created)||e.created(n),o(e.attached)||t.addListener(function(){e.attached(n)})}function P(e){var t=e.attrs.value;o(t)||(e.dom.value=t)}function J(e,t){if("input"===e&&t.attrs){var n=t.attrs.type;if("text"===n)P(t);else if("checkbox"===n||"radio"===n){var r=t.attrs.checked;t.dom.checked=!!r}}else"textarea"===e&&P(t)}function Q(e,t,n,r,o,l){if(M(e))return te(e,t);if(O(e))return ee(e,t);if(j(e))return $(e,t,n,r,o,l);if(D(e))return Z(e,t,n,r,o,l);var i=A(e);if(e!==i)return Q(i,t,n,r,o,l);throw new Error('Svenjs Error: invalid object "'+typeof e+'" passed to mount()')}function Z(e,t,n,r,o,l){var i=e.bp;if(d(i))return ie(e,t,n,r,o,l);if(Ie){var s=m(e,i,n,r,o);if(!u(s))return u(t)||t.appendChild(s),s}return le(e,i,t,n,r,o)}function $(e,t,n,r,o,l){var i=e.items,s=document.createTextNode(""),a=document.createDocumentFragment();return se(i,a,n,r,o,l),e.pointer=s,e.dom=a,a.appendChild(s),t&&T(t,a),a}function ee(e,t){var n=document.createTextNode(e.text);return e.dom=n,t&&T(t,n),n}function te(e,t){var n=document.createTextNode("");return e.dom=n,t&&T(t,n),n}function ne(e){"select"===e.tag&&q(e)}function re(e,t,n,r){ne(e);var o=e.attrs;if(u(t.attrKeys)){var l=Object.keys(o);t.attrKeys=t.attrKeys?t.attrKeys.concat(l):l}var i=t.attrKeys;fe(e,o,i,n,r)}function oe(e,t,n){var r=e.events;u(t.eventKeys)&&(t.eventKeys=Object.keys(r));var o=t.eventKeys;ce(r,o,n)}function le(e,t,n,r,o,l){var i=e.tag;if(c(t.isComponent))return de(e,i,e.attrs||{},e.hooks,e.children,l,n,r,o);var s=U(t.tag,t.isSVG);e.dom=s,c(t.hasHooks)&&B(e.hooks,r,s),c(t.lazy)&&Ee(e,r,s);var a=e.children;switch(t.childrenType){case 1:V(a,s,!0);break;case 2:Q(e.children,s,r,o,l,t.isSVG);break;case 3:se(a,s,r,o,l,t.isSVG);break;case 4:for(var d=0;d<a.length;d++)Q(a[d],s,r,o,l,t.isSVG);break;case 5:ae(e,a,s,r,o,l,t.isSVG)}return c(t.hasAttrs)&&re(e,t,s,l),c(t.hasClassName)&&(s.className=e.className),c(t.hasStyle)&&xe(null,e.style,s),c(t.hasEvents)&&oe(e,t,s),u(n)||n.appendChild(s),s}function ie(e,t,n,r,a,c){var d=e.tag;if(i(d))return de(e,d,e.attrs||{},e.hooks,e.children,a,t,n,r);if(!s(d)||""===d)throw Error("Svenjs Error: Expected function or string for element tag type");"svg"===d&&(c=!0);var f=U(d,c),h=e.children,m=e.attrs,v=e.events,p=e.hooks,g=e.className,y=e.style;return e.dom=f,o(p)||B(p,n,f),l(h)||ae(e,h,f,n,r,a,c),o(m)||(ne(e),fe(e,m,Object.keys(m),f,a)),o(g)||(f.className=g),o(y)||xe(null,y,f),o(v)||ce(v,Object.keys(v),f),u(t)||t.appendChild(f),f}function se(e,t,n,r,o,l){e.complex=!1;for(var i=0;i<e.length;i++){var s=H(e,i);O(s)?(ee(s,t),e.complex=!0):M(s)?(te(s,t),e.complex=!0):j(s)?($(s,t,n,r,o,l),e.complex=!0):Q(s,t,n,r,o,l)}}function ae(e,n,o,i,s,a,u){t(n)?se(n,o,i,s,a,u):r(n)?V(n,o,!0):l(n)||Q(n,o,i,s,a,u)}function ue(e,t,n){!l(e)&&s(t)?e.refs[t]=n:i(t)&&t(n)}function ce(e,t,n){for(var r=0;r<t.length;r++){var o=t[r];n[o]=e[o]}}function de(t,r,i,s,a,u,c,d,f){i=e(a,i);var h;if(n(r)){var m=new r(i,f);m._patch=he,m._componentToDOMNodeMap=nt,!o(u)&&i.ref&&ue(u,i.ref,m);var v=m.getChildContext();o(v)||(f=Object.assign({},f,v)),m.context=f,m._unmounted=!1,m._parentNode=t,u&&(m._parentComponent=u),m._pendingSetState=!0,m.componentWillMount();var p=m.render();l(p)&&(p=N()),m._pendingSetState=!1,h=Q(p,null,d,f,m,!1),m._lastNode=p,m.componentDidMount(),null===c||l(h)||c.appendChild(h),nt.set(m,h),t.dom=h,t.instance=m}else{o(s)||(o(s.componentWillMount)||s.componentWillMount(null,i),o(s.componentDidMount)||d.addListener(function(){s.componentDidMount(h,i)}));var g=r(i,f);l(g)&&(g=N()),h=Q(g,null,d,f,null,!1),t.instance=g,null===c||l(h)||c.appendChild(h),t.dom=h}return h}function fe(e,t,n,r,o){for(var l=0;l<n.length;l++){var i=n[l];"ref"===i?ue(h(e,o),t[i],r):Ce(i,null,t[i],r)}}function he(e,t,n,o,i,s,a){if(e!==t)if(l(e))Q(t,n,o,i,s,a);else if(l(t))K(e,n);else if(r(e))if(r(t))n.firstChild.nodeValue=t;else{var u=Q(t,null,o,i,s,a);t.dom=u,W(n,u,n.firstChild)}else if(r(t))W(n,document.createTextNode(t),e.dom);else if(j(t))j(e)?Se(e,t,n,o,i,s,a):(W(n,$(t,null,o,i,s,a),e.dom),p(e,null));else if(j(e))E(n,e,Q(t,null,o,i,s,a));else if(M(t))M(e)?Oe(e,t):(W(n,te(t,null),e.dom),p(e,null));else if(M(e))W(n,Q(t,null,o,i,s,a),e.dom);else if(O(t))O(e)?Me(e,t):(W(n,ee(t,null),e.dom),p(e,null));else if(O(e))W(n,Q(t,null,o,i,s,a),e.dom);else if(D(t))D(e)?ge(e,t,n,o,i,s,a,!1):(W(n,mountVNode(t,null,o,i,s,a),e.dom),p(e,null));else{if(!D(e))return he(e,A(t),n,o,i,s,a);W(n,Q(t,null,o,i,s,a),e.dom),p(e,null)}return t}function me(e,t,n){r(t)&&""!==t?e.firstChild.nodeValue=n:e.textContent=n}function ve(e,t,n,r){e&&(s(t)&&delete e.refs[t],s(n)&&(e.refs[n]=r))}function pe(e,n,o,i,s,a,u){var c=n.children,d=e.children;if(d!==c)if(l(d))r(c)?me(o,d,c):l(c)||(t(c)?se(c,o,i,s,a,u):Q(c,o,i,s,a,u));else if(l(c))X(o,d);else if(t(d))t(c)?(c.complex=d.complex,R(d,c)?je(d,c,o,i,s,a,u,null):_e(d,c,o,i,s,a,u,null)):_e(d,[c],o,i,s,a,u,null);else if(t(c)){var f=d;r(d)&&(f=C(f),f.dom=o.firstChild),_e([f],c,o,i,s,a,u,null)}else r(c)?me(o,d,c):r(d)?he(d,c,o,i,s,a,u):ge(d,c,o,i,s,a,u,!1)}function ge(e,t,n,r,o,l,i,s){var a=e.bp,u=t.bp;void 0===a||void 0===u?we(e,t,n,r,o,l,i):ye(e,t,a,u,n,r,o,l,s)}function ye(e,t,r,i,s,a,u,c,d){var f;i.hasHooks===!0&&(f=t.hooks,f&&!o(f.willUpdate)&&f.willUpdate(e.dom));var h=t.tag||i.tag,m=e.tag||r.tag;if(m!==h)if(r&&r.isComponent===!0){var v=e.instance;if(i.isComponent===!0)G(e,t,s,a,u,c,!1);else if(n(m)){y(e,null,!0);var p=v._lastNode;ye(p,t,p.bp,i,s,a,u,c,i.isSVG)}else y(e,null,!0),ye(v,t,v.bp,i,s,a,u,c,i.isSVG)}else G(e,t,s,a,u,c,i.isSVG);else if(o(m))t.dom=e.dom;else if(r&&r.isComponent===!0){if(i.isComponent===!0){var g=e.instance;if(!o(g)&&g._unmounted){var w=de(t,m,t.attrs||{},t.hooks,t.children,g,s,a,u);null!==s&&W(s,w,e.dom)}else t.instance=g,t.dom=e.dom,Ne(!0,t,t.tag,r,i,g,e.attrs||{},t.attrs||{},t.hooks,e.children,t.children,s,a,u)}}else{var k=e.dom,x=r.childrenType,b=i.childrenType;if(t.dom=k,i.lazy===!0&&d===!1){var C=e.clipData;if(null===a.scrollY&&a.refresh(),t.clipData=C,(C.pending===!0||C.top-a.scrollY>a.screenHeight)&&setClipNode(C,k,e,t,s,a,u,c,r.isSVG))return;if(C.bottom<a.scrollY&&setClipNode(C,k,e,t,s,a,u,c,r.isSVG))return}if(x>0||b>0)if(5===b||5===x)pe(e,t,k,a,u,c);else{var N=e.children,S=t.children;0===x||l(N)?b>2?se(S,k,a,u,c):Q(S,k,a,u,c):0===b||l(S)?x>2?X(k,N):K(N,k):N!==S&&(4===x&&4===b?je(N,S,k,a,u,c,i.isSVG,null):2===x&&2===b?he(N,S,k,a,u,c,!0,i.isSVG):1===x&&1===b?me(k,N,S):pe(e,t,k,a,u,c,i.isSVG))}if(r.hasAttrs!==!0&&i.hasAttrs!==!0||ke(e,t,r.attrKeys,i.attrKeys,k,c),r.hasEvents!==!0&&i.hasEvents!==!0||be(e.events,t.events,r.eventKeys,i.eventKeys,k),r.hasClassName===!0||i.hasClassName===!0){var _=t.className;e.className!==_&&(o(_)?k.removeAttribute("class"):k.className=_)}if(r.hasStyle===!0||i.hasStyle===!0){var O=t.style,M=e.style;M!==O&&xe(M,O,k)}i.hasHooks!==!0||o(f.didUpdate)||f.didUpdate(k),J(h,t)}}function we(e,t,r,l,s,a,u){var c=t.hooks,d=!o(c);d&&!o(c.willUpdate)&&c.willUpdate(e.dom);var f=t.tag||(o(t.bp)?null:t.bp.tag),h=e.tag||(o(e.bp)?null:e.bp.tag);if("svg"===f&&(u=!0),h!==f){var m=e.instance;i(h)?i(f)?G(e,t,r,l,s,a,u):n(h)?(y(e,null,!0),we(m._lastNode,t,r,l,s,a,u)):(y(e,null,!0),we(m,t,r,l,s,a,u)):G(m||e,t,r,l,s,a,u)}else if(o(h))t.dom=e.dom;else if(i(h)){if(i(f)){var v=e._instance;if(!o(v)&&v._unmounted){var p=de(t,h,t.attrs||{},t.hooks,t.children,v,r,l,s);null!==r&&W(r,p,e.dom)}else t.instance=e.instance,t.dom=e.dom,Ne(!1,t,t.tag,null,null,t.instance,e.attrs||{},t.attrs||{},t.hooks,e.children,t.children,r,l,s)}}else{var g=e.dom,w=t.className,k=t.style;t.dom=g,pe(e,t,g,l,s,a,u),ke(e,t,null,null,g,a),be(e.events,t.events,null,null,g),e.className!==w&&(o(w)?g.removeAttribute("class"):g.className=w),e.style!==k&&xe(e.style,k,g),d&&!o(c.didUpdate)&&c.didUpdate(g),J(f,t)}}function ke(e,t,n,r,l,i){"select"===e.tag&&q(t);var s=t.attrs,a=e.attrs,u=o(s),c=!o(a);if(!u)for(var d=r||Object.keys(s),f=d.length,h=0;h<f;h++){var m=d[h],v=c&&a[m],p=s[m];v!==p&&("ref"===m?ve(i,v,p,l):Ce(m,v,p,l))}if(c)for(var g=n||Object.keys(a),y=g.length,w=0;w<y;w++){var k=g[w];(u||o(s[k]))&&("ref"===k?ve(getRefInstance(node,i),a[k],null,l):l.removeAttribute(k))}}function xe(e,t,n){if(s(t))n.style.cssText=t;else if(o(e)){if(!o(t))for(var r=Object.keys(t),l=0;l<r.length;l++){var i=r[l],u=t[i];a(u)&&!Be[i]?n.style[i]=u+"px":n.style[i]=u}}else if(o(t))n.removeAttribute("style");else{for(var c=Object.keys(t),d=0;d<c.length;d++){var f=c[d],h=t[f];a(h)&&!Be[f]?n.style[f]=h+"px":n.style[f]=h}for(var m=Object.keys(e),v=0;v<m.length;v++){var p=m[v];o(t[p])&&(n.style[p]="")}}}function be(e,t,n,r,l){var i,s=!o(t),a=!o(e);if(a&&(i=n||Object.keys(e)),s){var u=r||Object.keys(t);if(a){for(var c=0;c<u.length;c++){var d=u[c],f=e[d],h=t[d];f!==h&&(l[d]=h)}for(var m=0;m<i.length;m++){var v=i[m];o(t[v])&&(l[v]=null)}}else ce(t,u,l)}else a&&Y(e,i,l)}function Ce(e,t,n,r){if("dangerouslySetInnerHTML"===e){var l=t&&t.__html,i=n&&n.__html;if(o(i))throw new Error("Svenjs Error: dangerouslySetInnerHTML requires an object with a __html propety containing the innerHTML content");l!==i&&(r.innerHTML=i)}else if("eventData"===e)r.eventData=n;else if(Re[e])r[e]=null===n?"":n;else if(Fe[e])r[e]=!!n;else{var s=qe[e];n===!1||o(n)?void 0!==s?r.removeAttributeNS(s,e):r.removeAttribute(e):void 0!==s?r.setAttributeNS(s,e,n===!0?e:n):r.setAttribute(e,n===!0?e:n)}}function Ne(t,r,i,s,a,u,c,d,f,h,m,v,p,g){if(d=e(m,d),n(i)){var y=u.props,w=u.state,k=u.state,x=u.getChildContext();o(x)||(g=Object.assign({},g,x)),u.context=g;var b=u._updateComponent(w,k,y,d);b===Le?b=u._lastNode:o(b)&&(b=N()),he(u._lastNode,b,v,p,g,u,null,!1),r.dom=b.dom,u._lastNode=b,u.componentDidUpdate(y,w),nt.set(u,b.dom)}else{var C=!0,S=t&&a.hasHooks===!0||!o(f);if(c=e(h,c),S&&!o(f.componentShouldUpdate)&&(C=f.componentShouldUpdate(r.dom,c,d)),C!==!1){S&&!o(f.componentWillUpdate)&&f.componentWillUpdate(r.dom,c,d);var _=i(d,g);l(_)&&(_=N()),_.dom=r.dom,he(u,_,v,p,g,null,null,!1),r.instance=_,S&&!o(f.componentDidUpdate)&&f.componentDidUpdate(r.dom,c,d)}}}function Se(e,t,n,r,o,l,i){var s=e.items,a=t.items,u=e.pointer;t.dom=e.dom,t.pointer=u,!s!==a&&(R(s,a)?je(s,a,n,r,o,l,i,t):_e(s,a,n,r,o,l,i,t))}function _e(e,t,n,r,o,l,i,s){for(var a=e.length,u=t.length,c=a>u?u:a,d=0;d<c;d++){var f=e[d],h=H(t,d);he(f,h,n,r,o,l,i)}if(a<u)for(d=c;d<u;d++){var m=H(t,d);T(n,Q(m,null,r,o,l,i),s&&s.pointer)}else if(a>u)for(d=c;d<a;d++)K(e[d],n)}function Oe(e,t){t.dom=e.dom}function Me(e,t){var n=t.text,r=e.dom;t.dom=r,e.text!==n&&(r.nodeValue=n)}function je(e,t,n,r,o,l,i,s){for(var a,u=e.length,c=t.length,d=u-1,f=c-1,h=0,m=0,v=null,p=null,g=null,y=null;h<=d&&m<=f&&(p=t[m],v=e[h],p.key===v.key);)ge(v,p,n,r,o,l,i,!1),m++,h++;for(;h<=d&&m<=f&&(g=t[f],y=e[d],g.key===y.key);)ge(y,g,n,r,o,l,i,!1),f--,d--;for(;h<=d&&m<=f&&(g=t[f],v=e[h],g.key===v.key);)a=f+1<c?t[f+1].dom:null,ge(v,g,n,r,o,l,i,!1),T(n,g.dom,a),f--,h++;for(;h<=d&&m<=f&&(p=t[m],y=e[d],p.key===y.key);)a=e[h].dom,ge(y,p,n,r,o,l,i,!1),T(n,p.dom,a),m++,d--;if(h>d){if(m<=f)for(a=f+1<c?t[f+1].dom:s&&s.pointer;m<=f;m++)T(n,Q(t[m],null,r,o,l,i),a)}else if(m>f)for(;h<=d;)K(e[h++],n);else{var w,k=d-h+1,x=f-m+1,b=new Array(x);for(w=0;w<x;w++)b[w]=-1;var C,N=!1,S=0,_=0,O=!0,M=0;if(x<=4||k*x<=16)for(w=h;w<=d;w++){if(O=!0,y=e[w],M<x)for(C=m;C<=f;C++)if(g=t[C],y.key===g.key){b[C-m]=w,_>C?N=!0:_=C,ge(y,g,n,r,o,l,i,!1),M++,O=!1;break}O&&(K(y,n),S++)}else{var j=new Map;for(w=m;w<=f;w++)j.set(t[w].key,w);for(w=h;w<=d;w++)O=!0,y=e[w],M<c&&(C=j.get(y.key),void 0!==C&&(g=t[C],b[C-m]=w,_>C?N=!0:_=C,ge(y,g,n,r,o,l,i,!1),M++,O=!1)),O&&(K(y,n),S++)}var D;if(N){var E=De(b);for(C=E.length-1,w=x-1;w>=0;w--)b[w]===-1?(D=w+m,a=D+1<c?t[D+1].dom:s&&s.pointer,T(n,Q(t[D],null,r,o,l,i),a)):C<0||w!==E[C]?(D=w+m,a=D+1<c?t[D+1].dom:s&&s.pointer,T(n,t[D].dom,a)):C--}else if(k-S!==x)for(w=x-1;w>=0;w--)b[w]===-1&&(D=w+m,a=D+1<c?t[D+1].dom:s&&s.pointer,T(n,Q(t[D],null,r,o,l,i),a))}}function De(e){var t=e.slice(0),n=[];n.push(0);var r,o,l,i,s;for(r=0;r<e.length;r++)if(e[r]!==-1)if(o=n[n.length-1],e[o]<e[r])t[r]=o,n.push(r);else{for(l=0,i=n.length-1;l<i;)s=(l+i)/2|0,e[n[s]]<e[r]?l=s+1:i=s;e[r]<e[n[l]]&&(l>0&&(t[r]=n[l-1]),n[l]=r)}for(l=n.length,i=n[l-1];l-- >0;)n[l]=i,i=t[i];return n}function Te(){this._listeners=[],this.scrollX=null,this.scrollY=null,this.screenHeight=Je,this.screenWidth=Pe}function Ee(e,t,n){t.addListener(function(){var r=n.getBoundingClientRect();null===t.scrollY&&t.refresh(),e.clipData={top:r.top+t.scrollY,left:r.left+t.scrollX,bottom:r.bottom+t.scrollY,right:r.right+t.scrollX,pending:!1}})}function Ue(e,t,n,r,o,l,i){var s=t[n.i];if(O(e)){var a=e.text;if(e.dom=s,3===s.nodeType&&""!==a)s.nodeValue=a;else{var u=ee(a);W(r,u,s),t.splice(t.indexOf(s),1,u),e.dom=u}}else if(M(e))e.dom=s;else if(j(e)){var c=e.items;e.dom=document.createDocumentFragment();for(var d=0;d<c.length;d++){var f=Ue(H(c,d),t,n,r,o,l,i);if(f)return!0}var h=t[n.i++];if(!h||3!==h.nodeType)return!0;e.pointer=h}else{var m=We(e,s,r,o,l,i,!1);if(m)return!0}n.i++}function Ve(e){for(var t=[],n=e.childNodes,r=n.length,o=0;o<r;){var l=n[o];if(8===l.nodeType)if("!"===l.data){var i=document.createTextNode("");e.replaceChild(i,l),t.push(i),o++}else e.removeChild(l),r--;else t.push(l),o++}return t}function Ge(t,r,i,s,a,u,c,d,f,h,m){if(i=e(a,i),!n(r)){var v=t.instance=r(i);return o(s)||(o(s.componentWillMount)||s.componentWillMount(null,i),o(s.componentDidMount)||d.addListener(function(){s.componentDidMount(u,i)})),We(v,u,c,d,f,v,m)}var p=t.instance=new r(i);p._patch=he,!o(h)&&i.ref&&ue(h,i.ref,p);var g=p.getChildContext();o(g)||(f=Object.assign({},f,g)),p.context=f,p._unmounted=!1,p._parentNode=t,h&&(p._parentComponent=h),p._pendingSetState=!0,p.componentWillMount();var y=p.render();p._pendingSetState=!1,l(y)&&(y=N()),We(y,u,c,d,f,p,m),p._lastNode=y,p.componentDidMount()}function We(e,n,l,s,a,u,c){var d=e.bp,f=e.tag||d.tag;if(i(f))e.dom=n,Ge(e,f,e.attrs||{},e.hooks,e.children,n,l,s,a,u,c);else if(1!==n.nodeType||f!==n.tagName.toLowerCase());else{e.dom=n;var h=e.hooks;(d&&d.hasHooks===!0||!o(h))&&B(h,s,n);var m=e.children;if(!o(m))if(r(m))n.textContent!==m&&(n.textContent=m);else{var v=Ve(n),p={i:0},g=!1;if(t(m))for(var y=0;y<m.length&&!(g=Ue(H(m,y),v,p,n,s,a,u));y++);else g=1!==v.length||Ue(m,v,p,n,s,a,u)}var w=e.className,k=e.style;if(o(w)||(n.className=w),o(k)||xe(null,k,n),d&&d.hasAttrs===!0)re(e,d,n,u);else{var x=e.attrs;o(x)||(ne(e),fe(e,x,Object.keys(x),n,u))}if(d&&d.hasEvents===!0)oe(e,d,n);else{var b=e.events;o(b)||ce(b,Object.keys(b),n)}}}function Ae(e,t,n){if(t&&1===t.nodeType){var r=t.querySelector("[data-sjsroot]");if(r&&r.parentNode===t)return We(e,r,t,n,{},!0),!0}return t!==et?t.textContent="":console.warn('Svenjs Warning: rendering to the "document.body" is dangerous! Use a dedicated container element instead.'),!1}function He(e){return nt.get(e)||null}function Ke(e,t){var n=tt.get(t),r=new Te;if(d(n))l(e)||(Ae(e,t,r)||Q(e,t,r,{},null,!1),r.trigger(),tt.set(t,{input:e}));else{var o=I(),i=he(n.input,e,t,r,{},null,!1);r.trigger(),u(e)&&tt.delete(t),n.input=i,z(o)}}var Le="NO_RENDER",Ye="undefined"!=typeof window&&window.document,Ie=!0;w.prototype={setAttrs:function(e){return this.attrs=e,this},setTag:function(e){return this.tag=e,this},setStyle:function(e){return this.style=e,this},setClassName:function(e){return this.className=e,this},setChildren:function(e){return this.children=e,this},setHooks:function(e){return this.hooks=e,this},setEvents:function(e){return this.events=e,this},setKey:function(e){return this.key=e,this}};var Xe="http://www.w3.org/1999/xlink",ze="http://www.w3.org/XML/1998/namespace",Re={},Fe={},qe={},Be={};_("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",qe,Xe),_("xml:base,xml:lang,xml:space",qe,ze),_("volume,value",Re,!0),_("muted,scoped,loop,open,checked,default,capture,disabled,selected,readonly,multiple,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",Fe,!0),_("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",Be,!0);var Pe=Ye&&window.screen.width,Je=Ye&&window.screen.height,Qe=0,Ze=0,$e=0;Ye&&(window.onscroll=function(){Qe=window.scrollX,Ze=window.scrollY,$e=performance.now()},window.resize=function(){Qe=window.scrollX,Ze=window.scrollY,Pe=window.screen.width,Je=window.screen.height,$e=performance.now()}),Te.prototype={refresh:function(){this.scrollX=Ye&&window.scrollX,this.scrollY=Ye&&window.scrollY},addListener:function(e){this._listeners.push(e)},trigger:function(){for(var e=this,t=0;t<this._listeners.length;t++)e._listeners[t]()}};var et=(new Map,Ye?document.body:null),tt=new Map,nt=new Map,rt={render:Ke,findDOMNode:He,mount:Q,patch:he,unmount:p};return rt});
